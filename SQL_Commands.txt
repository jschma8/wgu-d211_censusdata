download file 
extract all
destination location needs to be "C:\Users\Public"

Open pgAdmin4
In Browser, Open Server > Databases > Churn
right click on Churn and open Query Tool
In query editor copy and paste everything below:

--delete before upload
DROP TABLE census_raw
DROP TABLE census

-- SQL Commands: -- 
-- create the table census_raw -- 
create table census_raw
(Geographic_Area_Name varchar,
"State" varchar,
"2017_NAICS_code" varchar,
NAICS2017_LABEL varchar,
SEX_LABEL varchar,
ETH_GROUP_LABEL varchar,
RACE_GROUP_LABEL varchar,
VET_GROUP_LABEL varchar,
number_of_employer_firms varchar,
number_of_employees varchar,
"Annual_payroll_$1,000" varchar
);

-- import data --
COPY census_raw
FROM 'C:\Users\Public\wgu-d211_censusdata-main\ABSCS2020.AB2000CSA01-Data.csv'
DELIMITER ','
CSV HEADER;

-- clean up data --
--- drop rows ---
DELETE from census_raw where not "2017_NAICS_code" <> '0';
DELETE from census_raw where eth_group_label <> 'Total';
DELETE from census_raw where race_group_label <> 'Total';
DELETE from census_raw where vet_group_label <> 'Total';

-- create cleaned table --
CREATE TABLE census AS
    SELECT DISTINCT "State"
	    FROM census;

alter table census
add primary key ("State");
add column "firms" varchar;
add column "total_employees" varchar,
add column "total_payroll" varchar;
add column female_employees varchar;
add column female_payroll varchar;
add column male_employees varchar;
add column add male_payroll varchar;

-- add data to cleaned table
UPDATE census, census_raw
SET census.firms = census_raw.number_of_employer_firms
WHERE census.state = census_raw.state and census_raw.sex_label = 'Total'; 


select * from census;

